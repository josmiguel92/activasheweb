---
import { SEO } from "astro-seo";
import { SITE_URL } from "@/data/config";

type Props = {
  title?: string;
  description?: string;
  noindex?: boolean;
  image?: string;
  og?: {
    title: string;
    type: string;
    description: string;
    image: string;
    alt: string;
  };
};

const { title, description, noindex, image, og } = Astro.props;

const toAbsoluteUrl = (maybeUrl?: string) => {
  if (!maybeUrl) return undefined;
  if (maybeUrl.startsWith("http://") || maybeUrl.startsWith("https://")) return maybeUrl;
  const leadingSlash = maybeUrl.startsWith("/") ? "" : "/";
  return `${SITE_URL}${leadingSlash}${maybeUrl}`;
};

const DEFAULT_TITLE_PAGE = "ActivaShe | Visibilidad y Apoyo para Mujeres Afrodescendientes";
const DEFAULT_DESCRIPTION_PAGE =
  "ActivaShe: Damos voz a las mujeres afrodescendientes en situaci√≥n de vulnerabilidad. Trabajamos para visibilizar la injusticia y promover la equidad y los derechos humanos.";
const DEFAULT_URL_SITE = SITE_URL;
const DEFAULT_IMAGE = `${DEFAULT_URL_SITE}/favicon.png`;

const openGraph = {
  title: og?.title || title || DEFAULT_TITLE_PAGE,
  type: og?.type || "website",
  image: toAbsoluteUrl(og?.image || image) || DEFAULT_IMAGE,
  alt: og?.alt || "Logo de ActivaShe con el eslogan 'Visibilidad y Equidad'",
  url: DEFAULT_URL_SITE,
  description: og?.description || description || DEFAULT_DESCRIPTION_PAGE,
};
---

<SEO
  charset="UTF-8"
  title={title || DEFAULT_TITLE_PAGE}
  description={description || DEFAULT_DESCRIPTION_PAGE}
  noindex={noindex || false}
  openGraph={{
    basic: {
      title: openGraph.title,
      type: openGraph.type,
      image: openGraph.image,
    },
    image: {
      alt: openGraph.alt,
    },
  }}
  twitter={{
    creator: "@activashecuba",
  }}
  extend={{
    link: [
      { rel: "icon", href: "/favicon.png" },
      { rel: "sitemap", href: "/sitemap-index.xml" },
    ],
    meta: [
      { name: "viewport", content: "width=device-width, initial-scale=1" },
      { name: "generator", content: Astro.generator },
      {
        name: "twitter:image",
        content: openGraph.image,
      },
      { name: "twitter:card", content: "summary_large_image" },
      { name: "twitter:title", content: openGraph.title },
      { name: "twitter:description", content: openGraph.description },
      { name: "twitter:site", content: "@activashecuba" },
    ],
  }}
/>
