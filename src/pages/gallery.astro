---
import { getCollection } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import ArtGalleryGrid from "@/components/ArtGalleryGrid.astro";
import FeaturedVideo from "@/components/FeaturedVideo.astro";
import VideoGrid from "@/components/VideoGrid.astro";
import Button from "@/components/Button.astro";
import presentation from "@/data/presentation";
import "@/styles/art-gallery.css";

const artworks = await getCollection("art");
const videos = await getCollection("videos");

// Sort videos by publishedAt date
const sortedVideos = videos.sort(
  (a, b) => b.data.publishedAt.getTime() - a.data.publishedAt.getTime(),
);

// Get featured video or first one
const featuredVideo = videos.find((v) => v.data.featured) || sortedVideos[0];
const otherVideos = sortedVideos
  .filter((v) => v.slug !== featuredVideo.slug)
  .slice(0, 6);

// Get social links
const instagramLink =
  presentation.socials.find((s) => s.label === "Instagram")?.link ||
  "https://www.instagram.com/activashe";
const youtubeLink =
  presentation.socials.find((s) => s.label === "YouTube")?.link ||
  "https://www.youtube.com/@ActivaShe";
---

<Layout
  title="Galería | ActivaShe"
  bodyClass="bg-gradient-to-b from-olive to-olive/90"
>
  <div class="mx-auto max-w-4xl space-y-16 px-6 lg:max-w-6xl">
    <!-- Galería de Arte Section -->
    <section class="space-y-4">
      <div
        class="flex items-center justify-between border-l-4 border-terracotta pl-4"
      >
        <h1 class="font-display text-4xl font-bold text-warm-cream">
          Galería de <span class="text-mustard">Arte</span>
        </h1>
        <span class="material-symbols-outlined text-3xl text-mustard">
          brush
        </span>
      </div>

      <p class="text-lg text-warm-cream/70">
        Celebramos las voces creativas de nuestra comunidad. Aquí encuentras
        obras de artistas que cantan, pintan, tejen y crean historias de
        resistencia.
      </p>

      <div
        class="space-y-3 rounded-2xl border border-white/10 bg-white/5 p-6 text-warm-cream/90"
      >
        <h2 class="text-lg font-semibold text-warm-cream">Manifiesto:</h2>
        <p class="text-2sm leading-relaxed">
          Somos las voces que se niegan al silencio. Somos raíces que se
          entrelazan en la tierra y en la memoria. Desde la negritud, el
          feminismo y la espiritualidad, alzamos el canto por la libertad, la
          justicia y el bienestar de todxs. Cada trazo, cada gesto, cada color,
          es un acto de amor, de resistencia y de sanación. Porque nuestro arte
          es tambor, es rezo, es comunidad. Porque ser cimarrona es vivir sin
          cadenas. Es crear desde el fuego que arrasa para un nuevo nacimiento.
        </p>
      </div>

      <div class="mt-6">
        <ArtGalleryGrid artworks={artworks} />
      </div>

      <Button
        href={instagramLink}
        label="Explorar Más Arte"
        variant="secondary"
        showIcon={true}
        icon="arrow"
        class="mt-6 w-full border-warm-cream !text-warm-cream hover:border-warm-cream"
      />
    </section>

    <div class="h-px bg-terracotta/10"></div>

    <!-- Repositorio de Video Section -->
    <section class="space-y-4">
      <div
        class="flex items-center justify-between border-l-4 border-mustard pl-4"
      >
        <h2 class="font-display text-4xl font-bold text-warm-cream">
          Repositorio de Video
        </h2>
        <span class="material-symbols-outlined text-3xl text-vibrant-orange">
          movie
        </span>
      </div>

      <p class="text-lg text-warm-cream/70">
        Documentales, entrevistas y talleres que capturan el movimiento, la
        energía y las historias de transformación de ActivaShe.
      </p>

      <div class="mt-6">
        {featuredVideo && <FeaturedVideo featuredVideo={featuredVideo} />}
      </div>

      <div class="mt-8">
        <h3 class="mb-4 text-lg font-semibold text-warm-cream">Más Videos</h3>
        <VideoGrid videos={otherVideos} />
      </div>

      <Button
        href={youtubeLink}
        label="Ver más en YouTube"
        variant="primary"
        showIcon={true}
        icon="external"
        class="mt-8 w-full"
      />
    </section>
  </div>
</Layout>
