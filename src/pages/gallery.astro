---
import { getCollection } from "astro:content";
import Layout from "@/layouts/Layout.astro";
import ArtGalleryGrid from "@/components/ArtGalleryGrid.astro";
import FeaturedVideo from "@/components/FeaturedVideo.astro";
import VideoGrid from "@/components/VideoGrid.astro";
import Button from "@/components/Button.astro";
import "@/styles/art-gallery.css";

const artworks = await getCollection("art");
const videos = await getCollection("videos");

// Sort videos by publishedAt date
const sortedVideos = videos.sort(
  (a, b) => b.data.publishedAt.getTime() - a.data.publishedAt.getTime()
);

// Get featured video or first one
const featuredVideo = videos.find((v) => v.data.featured) || sortedVideos[0];
const otherVideos = sortedVideos
  .filter((v) => v.slug !== featuredVideo.slug)
  .slice(0, 6);
---


<Layout title="Galería | ActivaShe" bodyClass="bg-gradient-to-b from-olive to-olive/90">
  <div class="px-6 max-w-4xl lg:max-w-6xl mx-auto space-y-16">
    <!-- Galería de Arte Section -->
    <section class="space-y-4">
      <div class="flex items-center justify-between border-l-4 border-terracotta pl-4">
        <h1 class="text-4xl font-display font-bold text-warm-cream">
          Galería de Arte
        </h1>
        <span class="material-symbols-outlined text-mustard text-3xl">
          brush
        </span>
      </div>

      <p class="text-warm-cream/70 text-lg">
        Celebramos las voces creativas de nuestra comunidad. Aquí encuentras obras
        de artistas que cantan, pintan, tejen y crean historias de resistencia.
      </p>

      <div class="mt-6">
        <ArtGalleryGrid artworks={artworks} />
      </div>

      <Button 
        href="https://www.instagram.com/activashe"
        label="Explorar Más Arte"
        variant="secondary"
        showIcon={true}
        icon="arrow"
        class="w-full mt-6 !text-warm-cream border-warm-cream hover:border-warm-cream"
      />
    </section>

    <div class="h-px bg-terracotta/10"></div>

    <!-- Repositorio de Video Section -->
    <section class="space-y-4">
      <div class="flex items-center justify-between border-l-4 border-mustard pl-4">
        <h2 class="text-4xl font-display font-bold text-warm-cream">
          Repositorio de Video
        </h2>
        <span class="material-symbols-outlined text-vibrant-orange text-3xl">
          movie
        </span>
      </div>

      <p class="text-warm-cream/70 text-lg">
        Documentales, entrevistas y talleres que capturan el movimiento, la energía
        y las historias de transformación de ActivaShe.
      </p>

      <div class="mt-6">
        {featuredVideo && <FeaturedVideo featuredVideo={featuredVideo} />}
      </div>

      <div class="mt-8">
        <h3 class="text-lg font-semibold text-warm-cream mb-4">Más Videos</h3>
        <VideoGrid videos={otherVideos} />
      </div>

      <Button 
        href="https://www.youtube.com/@ActivaShe"
        label="Ver más en YouTube"
        variant="primary"
        showIcon={true}
        icon="external"
        class="w-full mt-8"
      />
    </section>
  </div>
</Layout>
